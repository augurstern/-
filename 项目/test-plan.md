# 合同管理系统测试计划

## 1. 测试策略概述

本测试计划旨在对合同管理系统进行全面测试，确保系统功能正常、稳定和安全。测试将涵盖单元测试、集成测试和端到端测试，重点关注核心业务流程和用户体验。

## 2. 测试环境

### 前端测试环境
- Vue 3 + TypeScript
- Vitest (单元测试)
- Cypress (端到端测试)

### 后端测试环境
- Node.js + Express
- Jest (单元测试)
- Supertest (API测试)

## 3. 测试类型

### 3.1 单元测试

#### 前端单元测试
- 组件测试：验证UI组件的渲染和交互
- Store测试：验证状态管理逻辑
- 工具函数测试：验证辅助函数的正确性

#### 后端单元测试
- 数据库操作测试
- 业务逻辑测试
- API路由测试

### 3.2 集成测试

- API集成测试：验证前后端交互
- 数据流测试：验证数据在系统中的流转

### 3.3 端到端测试

- 用户流程测试：模拟真实用户操作
- 跨组件交互测试：验证系统整体功能

## 4. 测试范围

### 4.1 核心功能测试

#### 合同管理
- 合同创建、编辑、删除
- 合同状态流转
- 合同搜索和筛选
- 合同模板管理

#### 审批流程
- 审批流程创建和配置
- 审批节点流转
- 审批超时处理
- 审批权限控制

#### 支付计划
- 支付计划创建和管理
- 付款提醒和通知
- 付款状态跟踪

#### 通知系统
- 通知创建和发送
- 通知状态管理
- 通知设置和偏好

### 4.2 非功能测试

- 性能测试：响应时间和资源使用
- 安全测试：权限控制和数据保护
- 兼容性测试：浏览器和设备兼容性

## 5. 测试用例

### 5.1 前端单元测试用例

#### 通知组件测试
- 测试通知徽章显示正确的未读数量
- 测试通知列表正确渲染通知项
- 测试通知面板的展开和折叠功能
- 测试通知类型设置的保存功能

#### 合同组件测试
- 测试合同表单验证逻辑
- 测试合同列表的筛选和排序功能
- 测试合同详情页的数据展示

### 5.2 后端单元测试用例

#### 数据库操作测试
- 测试合同创建和查询功能
- 测试数据库事务的提交和回滚
- 测试复杂查询的正确性

#### API路由测试
- 测试合同API的参数验证
- 测试权限控制和认证逻辑
- 测试错误处理和响应格式

### 5.3 端到端测试用例

#### 合同全流程测试
- 测试从合同创建到审批再到履约的完整流程
- 测试合同状态变更触发的通知和提醒
- 测试合同搜索和高级筛选功能

#### 审批流程测试
- 测试多级审批流程的正确流转
- 测试审批超时自动处理机制
- 测试审批拒绝和退回逻辑

## 6. 测试执行计划

### 6.1 单元测试执行

#### 前端单元测试
```bash
cd frontend
npm run test       # 运行所有单元测试
npm run test:watch # 监视模式运行测试
npm run test:coverage # 生成测试覆盖率报告
```

#### 后端单元测试
```bash
cd backend
npm run test
```

### 6.2 端到端测试执行

```bash
cd frontend
npm run cypress:open # 交互式运行Cypress测试
npm run test:e2e     # 命令行运行所有端到端测试
```

### 6.3 CI/CD集成测试

项目已配置GitHub Actions工作流，在代码推送和PR时自动运行测试：

```yaml
name: E2E Tests

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: 18

    - name: Install dependencies
      run: |
        cd frontend
        npm ci
        cd ../backend
        npm ci

    - name: Start services
      run: |
        cd backend
        npm run start:dev &
        cd ../frontend
        npm run dev &

    - name: Run Cypress tests
      run: |
        cd frontend
        npx cypress run --config baseUrl=http://localhost:5173

    - name: Cleanup test database
      run: rm backend/test-db.sqlite
```

## 7. 测试报告

### 7.1 测试覆盖率报告

前端测试覆盖率报告将通过Vitest生成，后端测试覆盖率报告将通过Jest生成。报告将包含：

- 代码行覆盖率
- 分支覆盖率
- 函数覆盖率
- 语句覆盖率

### 7.2 测试结果报告

测试结果报告将包含：

- 测试用例总数
- 通过/失败/跳过的测试用例数量
- 测试执行时间
- 失败测试的详细信息和截图

## 8. 测试维护

### 8.1 测试代码维护

- 测试代码应遵循与产品代码相同的代码规范
- 测试用例应具有清晰的描述和预期结果
- 测试数据应易于维护和更新

### 8.2 测试自动化

- 所有测试应尽可能自动化
- 测试应集成到CI/CD流程中
- 测试结果应自动通知相关人员

## 9. 测试责任

- 开发人员负责编写和维护单元测试
- QA团队负责编写和维护集成测试和端到端测试
- 所有团队成员共同负责测试质量和覆盖率

## 10. 测试完成标准

- 所有测试用例通过率达到95%以上
- 代码覆盖率达到80%以上
- 所有关键功能和高风险区域有完整的测试覆盖
- 所有已知bug已修复并通过回归测试